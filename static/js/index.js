// Generated by CoffeeScript 1.4.0
(function() {

  $('.list-view').each(function() {
    var id;
    id = $(this).attr('id');
    return Sortable.create(document.getElementById(id), {
      group: "list-view",
      animation: 150,
      ghostClass: "ghost",
      chosenClass: "chosen",
      filter: ".undrag",
      onUpdate: function(event) {
        return console.log(event);
      },
      onAdd: function(event) {
        return console.log(event);
      }
    });
  });

  $.app.controller('TaskCtrl', function($scope) {
    $scope.o = {
      todo: null,
      doing: null,
      done: null
    };
    $scope.todo = {
      title: '',
      type: 1
    };
    $scope.edit = false;
    $scope.insert = function(type) {
      $scope.edit = true;
      setTimeout(function() {
        return $("#text-" + type).focus();
      }, 100);
      return false;
    };
    $scope.cancel_add = function(type) {
      return $scope.edit = false;
    };
    return $scope.add = function() {
      $.only_ajax({
        method: 'POST',
        url: '/j/task',
        data: $scope.todo,
        success: function() {
          return $.only_ajax({
            url: "/j/task/list?type=1",
            success: function(r) {
              var v;
              v = angular.element($("[ng-controller=TaskCtrl]")).scope();
              v.o.todo = r.data;
              return v.$apply();
            }
          });
        }
      });
      return false;
    };
  });

  $.only_ajax({
    url: "/j/task/list?type=1",
    success: function(r) {
      var v;
      v = angular.element($("[ng-controller=TaskCtrl]")).scope();
      v.o.todo = r.data;
      return v.$apply();
    }
  });

  $.only_ajax({
    url: "/j/task/list?type=2",
    success: function(r) {
      var v;
      v = angular.element($("[ng-controller=TaskCtrl]")).scope();
      v.o.doing = r.data;
      return v.$apply();
    }
  });

  $.only_ajax({
    url: "/j/task/list?type=3",
    success: function(r) {
      var v;
      v = angular.element($("[ng-controller=TaskCtrl]")).scope();
      v.o.done = r.data;
      return v.$apply();
    }
  });

}).call(this);
